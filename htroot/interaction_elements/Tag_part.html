<style type="text/css" >

.sci_tag {
	
font: arial,helvetica,sans-serif;
font-size: 10px;
background: #ffffff;
border:0px;

width: 65px;
height: 20px;


z-index:99998;

color: #5a346e;

}

</style>

<span id="sci_tags_#[hash]#" class="sci_tag" style="display: none;">
	<img id="sci_tags_#[hash]#_img" src="/currentyacypeer/interaction_elements/tag.png" width="16px" height="16px" alt="0" onclick="/* $('#sci_tags_#[hash]#_box').toggle();*/ return false">&nbsp; <span style="font-size: x-small; position: absolute; margin-top: 4px;"><span id="sci_tags_#[hash]#_tags"></span></span>
</span>

<div id="sci_tags_#[hash]#_box" class="sci_panel" style="top: 50px; display: none;">

	<div id="rdfcontent_#[hash]#" class="rdfcontent_#[hash]#" style="display:none;"></div>

	<input type="text" id="tags_#[hash]#" name="tags_#[hash]#" class="bm_input" size="80" />
	
</div>

<script type="text/javascript" charset="utf-8">
	
	var vocabularies_string = '#[vocabularies]#';
	
	var vocs = vocabularies_string.split (",");
	
	var existingtags = "";
	
	var resultstring = "";
	
	if (vocabularies_string != "") {

		$.ajaxSetup({async: false});

		$.getJSON('/currentyacypeer/api/yacydoc.json?urlhash=#[hash]#', function(data) {

			resultstring = data.result;
		});
	}
	
	

	vocs.forEach (function(voc) {
		
		var currenttags = triple_get_prefix ('http://yacy.net/url', '#[hash]#', 'http://yacy.net/autotagging', voc);
		
		var finaltags  = "";
		
		currenttags.split(',').forEach (function(tag) {
			var link = "";
			
			resultstring.split(',').forEach (function(hyperlink) {
			
				var h_url = hyperlink.substring (0, hyperlink.indexOf('#'));
				var h_tag = hyperlink.substring (hyperlink.indexOf('#')+1);
				
				if (h_tag == tag) {
					link = h_url;
				}
			});
			
			
			if (link != "") {
				finaltags = finaltags + "<a href='"+link +"' target='_blank'>" + tag + "</a>&nbsp;";
			}	
			else {
				finaltags = finaltags + tag + '&nbsp';
			}
		});
		
		if (existingtags != "" && currenttags != "") existingtags += " - ";
		if (currenttags != "") existingtags += voc+":"+ finaltags;
	});
	

	if (existingtags != "") {
		document.getElementById('sci_tags_#[hash]#').style.display = "";
		document.getElementById('sci_tags_#[hash]#_tags').innerHTML = existingtags;
	}
	
	
	
	/* document.getElementById('tags_#[hash]#').value = existingtags;
	
	$('#tags_#[hash]#').tagsInput({
  	   'height':'105px',
 	   'width':'270px',
 	   'interactive':true,
 	   'removeWithBackspace' : true,
 	   'minChars' : 0,
 	   'maxChars' : 0,
 	   'placeholderColor' : '#666666',
 	   'onChange' : function () {
 	   		storevalue_t ('http://yacy.net/url#[hash]#', 'http://yacy.net/autotagging#manual', document.getElementById('tags_#[hash]#').value);
 	   		}  	   
     }); */ 
</script>

